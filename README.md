# AVZ Logs Fixer

Авторы: Dragokas & regist

## Назначение:
Утилита ALF предназначена для исправления ошибок в логе XML от AVZ,
которые не позволяют обработать его в парсерах или просмотреть в программе чтения XML-файлов.
Позже в утилиту было добавлено и несколько фиксов для HTM.

## Способы использования:
* перетянуть архив или XML-файл на скрипт или его ярлык;
* запустить скрипт и **указать папку** с архивом / XML-логом (или указать архив .ZIP);
* через контекстное меню файла лога -> "Отправить". Для этого выполните установку через **"Установка в контекстное меню "Отправить".vbs".**

Можно выделять сразу множество логов.
Новый архив или XML будет перепакован под "старым именем_fix.zip" (.xml)

## Настройки задаются в шапке скрипта:

----------------------------------------------------------------------------------
' <<< ------ Укажите основную папку, где Вы сохраняете логи AVZ !!!
**LogFolder = "c:\Ваша папка с логами"**
' <<< ------ true - Копировать путь к исправленному логу в буфер обмена
**CopytoBufer = false**
' <<< ------ Silent-режим. Укажите значение true, если не хотите получать лишних окон: "Готово", "Архив уже существует..." и т.п.
**Silent = false**
' <<< ------ Если true, то не создавать новый архив. Фиксить сразу в исходном файле.
**NoBackup = false**
' <<< ------ Вызов внешнего парсера логов по завершению работы фикса (укажите полный путь к EXE)
**AVZParser = ""**
' <<< ------ Ключи и аргументы при вызове парсера. Макрос <LOG> будет заменен на полный путь к исправленному логу.
**ParserSwitches = "<LOG>"**
----------------------------------------------------------------------------------

## Исправляет такие проблемы с XML:
Фикс 1. Дублирование параметра Is64.
Фикс 2. Неэкранированный амперсанд в имени профиля пользователя.
Фикс 3. Символы NUL и другие служебные, кроме TAB, CR, LF
Фикс 4. Параметр CheckResult написан слитно с предыдущим значением.
Фикс 5. Неэкранированное значение <local> в параметре VAL секции Key.
Фикс 6. Неэкранированная кавычка в параметре "CmdLine" секции <PROCESS>.
фикс 8a - Выдаёт предупреждение, если в логе дублируется секция <WMI_INFO>
фикс 8b - Выдаёт предупреждение, если в логе дублируется секция <NET_DIAG>
фикс 9 - Выдаёт предупреждение, если в логе нет закрывающего тега </NET_DIAG>

## Исправляет такие проблемы с HTM:
Фикс 3. Символы NUL.
Фикс 7. Неэкранированные знаки '<' и '>' в аргументах командной строки секции "Список процессов"
